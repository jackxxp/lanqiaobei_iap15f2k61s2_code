C51 COMPILER V9.60.7.0   KEY                                                               01/23/2026 16:43:38 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE KEY
OBJECT MODULE PLACED IN .\Objects\key.obj
COMPILER INVOKED BY: C:\Program Files (x86)\keil\C51\BIN\C51.EXE key.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT
                    -(.\Listings\key.lst) TABS(2) OBJECT(.\Objects\key.obj)

line level    source

   1          #include "key.h"
   2          
   3          static uint8 key_ram = 200;
   4          
   5          void key_run()
   6          {
   7   1          static uint8 key_step = 0;
   8   1          static uint8 key_ptime = 0;
   9   1          static uint8 saved_key = 0; // ğŸ‘ˆ æ–°å¢ï¼šä¿å­˜åŸå§‹é”®å€¼ï¼ˆ4ï½19ï¼‰
  10   1      
  11   1          uint8 key_now = 0xFF;
  12   1          uint8 key_temp = 201; // é»˜è®¤æ— æ•ˆ
  13   1      
  14   1          // è¡Œæ‰«æï¼šæ‹‰ä½æ‰€æœ‰è¡Œ
  15   1          P3 = 0x0F;
  16   1          P42 = 0;
  17   1          P44 = 0;
  18   1          P36 = P42;
  19   1          P37 = P44;
  20   1          key_now = P3 & 0x0F;
  21   1      
  22   1          switch(key_step)
  23   1          {
  24   2              case 0: // ç©ºé—²æ€
  25   2                  if (key_now != 0x0F) {
  26   3                      key_step = 1;
  27   3                  }
  28   2                  break;
  29   2      
  30   2              case 1: // æ£€æµ‹åˆ°æœ‰é”®æŒ‰ä¸‹ï¼Œå¼€å§‹åˆ—æ‰«æ
  31   2                  if (key_now == 0x0F) {
  32   3                      key_step = 0; // æŠ–åŠ¨ï¼Œå›åˆ°ç©ºé—²
  33   3                  } else {
  34   3                      // åˆ‡æ¢åˆ°åˆ—è¾“å‡ºæ¨¡å¼
  35   3                      P3 = key_now | 0xF0;
  36   3                      P42 = 1;
  37   3                      P44 = 1;
  38   3                      P36 = P42;
  39   3                      P37 = P44;
  40   3                      key_now = P3; // è¯»å–å®Œæ•´é”®å€¼
  41   3      
  42   3                      // è¯†åˆ«é”®å€¼
  43   3                      switch (key_now) 
  44   3                      {
  45   4                          case 0x77: saved_key = 4; break;
  46   4                          case 0x7B: saved_key = 5; break;
  47   4                          case 0x7D: saved_key = 6; break;
  48   4                          case 0x7E: saved_key = 7; break;
  49   4      
  50   4                          case 0xB7: saved_key = 8; break;
  51   4                          case 0xBB: saved_key = 9; break;
  52   4                          case 0xBD: saved_key = 10; break;
  53   4                          case 0xBE: saved_key = 11; break;
  54   4      
C51 COMPILER V9.60.7.0   KEY                                                               01/23/2026 16:43:38 PAGE 2   

  55   4                          case 0xD7: saved_key = 12; break;
  56   4                          case 0xDB: saved_key = 13; break;
  57   4                          case 0xDD: saved_key = 14; break;
  58   4                          case 0xDE: saved_key = 15; break;
  59   4      
  60   4                          case 0xE7: saved_key = 16; break;
  61   4                          case 0xEB: saved_key = 17; break;
  62   4                          case 0xED: saved_key = 18; break;
  63   4                          case 0xEE: saved_key = 19; break;
  64   4                          default:
  65   4                              key_step = 0;
  66   4                              saved_key = 201;
  67   4                              return; // é€€å‡ºï¼Œä¸æ›´æ–° key_ram
  68   4                      }
  69   3                      key_step = 2;
  70   3                  }
  71   2                  break;
  72   2      
  73   2              case 2: // ç­‰å¾…é‡Šæ”¾ï¼ˆçŸ­æŒ‰ï¼‰æˆ–è¿›å…¥é•¿æŒ‰
  74   2                  // é‡æ–°è¯»å–è¡ŒçŠ¶æ€
  75   2                  P3 = 0x0F;
  76   2                  P42 = 0;
  77   2                  P44 = 0;
  78   2                  P36 = P42;
  79   2                  P37 = P44;
  80   2                  key_now = P3 & 0x0F;
  81   2      
  82   2                  if (key_now != 0x0F) {
  83   3                      // æŒ‰é”®ä»æŒ‰ä¸‹ï¼Œè®¡æ—¶
  84   3                      key_ptime++;
  85   3                      if (key_ptime > 70) { // é•¿æŒ‰é˜ˆå€¼
  86   4                          key_ptime = 0;
  87   4                          key_step = 3;
  88   4                          // æ³¨æ„ï¼šé•¿æŒ‰ç»“æœåœ¨æ¾æ‰‹æ—¶æ‰ä¸ŠæŠ¥
  89   4                      }
  90   3                  } else {
  91   3                      // çŸ­æŒ‰ï¼šæ¾æ‰‹äº†
  92   3                      key_ptime = 0;
  93   3                      key_step = 0;
  94   3                      key_temp = saved_key; // ğŸ‘ˆ ä½¿ç”¨ä¿å­˜çš„é”®å€¼
  95   3                  }
  96   2                  break;
  97   2      
  98   2              case 3: // é•¿æŒ‰ç­‰å¾…æ¾æ‰‹
  99   2                  P3 = 0x0F;
 100   2                  P42 = 0;
 101   2                  P44 = 0;
 102   2                  P36 = P42;
 103   2                  P37 = P44;
 104   2                  key_now = P3 & 0x0F;
 105   2      
 106   2                  if (key_now == 0x0F) {
 107   3                      // æ¾æ‰‹ï¼Œä¸ŠæŠ¥é•¿æŒ‰
 108   3                      key_step = 0;
 109   3                      key_temp = saved_key + 100; // ğŸ‘ˆ æ­£ç¡®ï¼šåŸå§‹é”®å€¼+100
 110   3                  }
 111   2                  break;
 112   2          }
 113   1      
 114   1          key_ram = key_temp;
 115   1      }
 116          
C51 COMPILER V9.60.7.0   KEY                                                               01/23/2026 16:43:38 PAGE 3   

 117          uint8 key_get()
 118          {
 119   1          uint8 temp = key_ram;
 120   1          key_ram = 201; // æ¸…é™¤ï¼Œé¿å…é‡å¤ä¸ŠæŠ¥
 121   1          return temp;
 122   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    342    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
